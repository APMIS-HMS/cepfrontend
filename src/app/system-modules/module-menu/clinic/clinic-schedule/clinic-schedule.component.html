<div class="page-title">Clinic Schedule</div>
<div class="schedule-wrap">
    <div class="lhsInnerFrm">
        <div class="sect-title">Add Clinic Schedule</div>
        <div class="dx-fieldset">
            <form action="/Login" method="post">
                <div class="frmitemwrap">
                    <!--<div class="frm-label">Clinic</div>-->
                    <!--<div class="dx-field">
                       <dx-lookup [dataSource]="clinics" [formControl]="locationTypeControl" [grouped]="false" [closeOnOutsideClick]="true" [showPopupTitle]="false"
                            displayExpr="clinicName">
                        </dx-lookup>
                    </div>-->
                    <md-select placeholder="Clinic" [formControl]="locationTypeControl">
                        <md-option *ngFor="let clinic of clinics" [value] = "clinic" >{{ clinic.clinicName }}</md-option>
                    </md-select>
                </div>
                <form *ngIf="locationTypeControl.value != null" [formGroup]="clinicScheduleForm" class="form-horizontal" (ngSubmit)="onSubmit()">
                    <div formArrayName="clinicScheduleArray" class="frmArrayWrap">
                        <div class="frmArray" *ngFor="let schedule of clinicScheduleForm.controls['clinicScheduleArray'].controls; let i = index;">
                            <div (click)="closeClinicSchedule(schedule, i)" class="closeIcon"><i class="fa fa-times-circle-o" aria-hidden="true"></i></div>
                            <div formGroupName="{{i}}">
                                <div>
                                    <div class="frmitemwrap">
                                        <!--<div class="frm-label">Day</div>-->
                                        <!--<div class="dx-field">
                                            <dx-select-box [items]="days" formControlName="day"></dx-select-box>
                                        </div>-->
                                    <md-select placeholder="Days" formControlName="day">
                                        <md-option *ngFor="let day of days" [value] = "day" >{{day}}</md-option>
                                    </md-select>
                                    </div>

                                    <div class="frmitemwrap">
                                        <!--<div class="dx-field">
                                            <div class="frm-label">Start Time</div>
                                            <div class="dx-field-value">
                                                <dx-date-box formControlName="startTime" type="time">
                                                </dx-date-box>
                                            </div>
                                        </div>
                                        <!--<md-input-container class="example-full-width">
                                            <input type="time" mdInput placeholder="Start Time">
                                        </md-input-container>-->
                                    </div>

                                    <div class="frmitemwrap">
                                        <div class="dx-field">
                                            <div class="frm-label">End Time</div>
                                            <div class="dx-field-value">
                                                <dx-date-box formControlName="endTime" type="time">
                                                </dx-date-box>
                                            </div>
                                        </div>
                                        <!-- <md-input-container class="example-full-width">
                                            <input type="time" mdInput placeholder="End Time">
                                        </md-input-container>-->
                                    </div>

                                    <div class="frmitemwrap">
                                        <!--<div class="frm-label">Location</div>
                                        <div class="dx-field">
                                            <dx-lookup [dataSource]="clinicLocations" formControlName="location" displayExpr="name" [showPopupTitle]="false">
                                            </dx-lookup>
                                        </div>-->
                                        <md-select placeholder="Location" formControlName="location">
                                             <md-option *ngFor="let location of clinicLocations" [value]="location">{{ location.name }}</md-option>
                                        </md-select>
                                    </div>
                                </div>
                            </div>

                            <div *ngIf="schedule.value.readOnly == true || schedule.value.valid == true" (click)="pushNewClinicSchedule(schedule)" class="addFrmLink"><i class="fa fa-plus" aria-hidden="true"></i><span>Add Schedule</span></div>
                        </div>
                    </div>

                </form>

                <div *ngIf="clinicScheduleForm.controls['clinicScheduleArray'].value.length === 0 && locationTypeControl.value != null" (click)="pushNewClinicSchedule(schedule)"
                    class="addFrmLink"><i class="fa fa-plus" aria-hidden="true"></i><span>Add Schedule</span></div>
                <!--<button *ngIf="locationTypeControl.value != null" [disabled]="clinicScheduleForm.controls['clinicScheduleArray'].valid == false || clinicScheduleForm.controls['clinicScheduleArray'].value.length === 0"
                    (click)="onCreateSchedule()" class="cta-1 btn-green">CREATE</button>-->
                <button *ngIf="locationTypeControl.value != null"
                 [disabled]="clinicScheduleForm.controls['clinicScheduleArray'].valid == false || 
                clinicScheduleForm.controls['clinicScheduleArray'].value.length === 0"
                class="apmis-blue" (click)="onCreateSchedule()" md-raised-button>Create</button>
            </form>

        </div>
    </div>

    <div class="rhsInnerCArea">
        <ul>
            <li class="listHeader">
                <div class="li-Item" style="cursor: pointer;">Clinic<i style="padding-left: 10px;" class="fa fa-sort" aria-hidden="true"></i></div>
                <div class="li-Item" style="cursor: pointer;">Department<i style="padding-left: 10px;" class="fa fa-sort" aria-hidden="true"></i></div>
                <div class="li-Item" style="cursor: pointer;">Unit<i style="padding-left: 10px;" class="fa fa-sort" aria-hidden="true"></i></div>
                <div class="li-Item-group">Schedule</div>
                <div class="li-cta"></div>
            </li>

            <li (click)="onSelectSchedulerManager(manager)" *ngFor="let manager of scheduleManagers" class="li-itemWrap">
                <div class="li-Item">{{manager.locationType.clinicName}}</div>
                <div class="li-Item">{{manager.locationType.department.name}}</div>
                <div class="li-Item">{{manager.locationType.unit.name}}</div>
                <div class="li-Item-group">
                    <div class="group-wrap" *ngFor="let schedule of manager.schedules">
                        <div class="group-Item">{{schedule.day}}</div>
                        <div class="group-Item">{{schedule.startTime | date:'shortTime'}} - {{schedule.endTime | date:'shortTime'}}</div>
                        <div class="group-Item">{{schedule.location.name}}</div>
                    </div>
                </div>
                <div class="li-cta">
                    <i (click)="onSelectSchedulerManager(manager)" class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    <i class="fa fa-trash" aria-hidden="true"></i>
                </div>
            </li>
        </ul>
    </div>
</div>